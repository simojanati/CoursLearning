/* App-specific tweaks (kept minimal to preserve Sneat design) */
:root{ --app-brand:#696cff; }

.app-hero{
  border: 1px solid rgba(105,108,255,.12);
  background: rgba(105,108,255,.06);
}

.code-block{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: .9rem;
  white-space: pre;
  overflow: auto;
  padding: 1rem;
  border-radius: .5rem;
  border: 1px solid rgba(67,89,113,.2);
  background: rgba(67,89,113,.04);
}

.lesson-content img{max-width:100%;height:auto;}

/* Small helper for empty states */
.empty-state{
  padding: 2.5rem 1.5rem;
  border: 1px dashed rgba(67,89,113,.25);
  border-radius: .75rem;
}


/* i18n + RTL support */
.rtl { direction: rtl; font-family: "Cairo", "Public Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
.ltr { direction: ltr; }

.rtl .layout-menu { left: auto !important; right: 0 !important; }
.rtl .layout-page { margin-left: 0 !important; margin-right: 16.25rem !important; }

@media (max-width: 1199.98px){
  .rtl .layout-page { margin-right: 0 !important; }
}

/* Swap common spacing utilities (minimal set for our pages) */
.rtl .ms-auto { margin-left: 0 !important; margin-right: auto !important; }
.rtl .ms-1 { margin-left: 0 !important; margin-right: .25rem !important; }
.rtl .me-2 { margin-right: 0 !important; margin-left: .5rem !important; }
.rtl .me-3 { margin-right: 0 !important; margin-left: 1rem !important; }
.rtl .text-end { text-align: left !important; }

@media (max-width: 575.98px){
  .table-responsive { font-size: .95rem; }
  .list-group-item .btn { white-space: nowrap; }
}


/* RTL FIX v2 */
html[dir="rtl"] {
  direction: rtl;
}

/* Place the sidebar on the RIGHT in RTL */
html[dir="rtl"].layout-menu-fixed .layout-menu,
html[dir="rtl"].layout-menu-fixed-offcanvas .layout-menu {
  left: auto !important;
  right: 0 !important;
}

/* Shift the page content to the LEFT (padding-right instead of padding-left) */
@media (min-width: 1200px) {
  html[dir="rtl"].layout-menu-fixed:not(.layout-menu-collapsed) .layout-page,
  html[dir="rtl"].layout-menu-fixed-offcanvas:not(.layout-menu-collapsed) .layout-page {
    padding-left: 0 !important;
    padding-right: 16.25rem !important;
  }
}

/* When menu is collapsed, keep spacing on the right */
@media (min-width: 1200px) {
  html[dir="rtl"].layout-menu-fixed.layout-menu-collapsed .layout-page,
  html[dir="rtl"].layout-menu-fixed-offcanvas.layout-menu-collapsed .layout-page {
    padding-left: 0 !important;
    padding-right: 5.25rem !important;
  }
}

/* Navbar / detached navbar alignment */
html[dir="rtl"] .layout-navbar {
  left: 0;
  right: 0;
}

/* Menu icon spacing */
html[dir="rtl"] .menu-icon {
  margin-right: 0 !important;
  margin-left: 0.5rem !important;
}

/* Submenu indentation: flip paddings */
html[dir="rtl"] .menu-vertical .menu-sub .menu-link {
  padding-left: 0 !important;
  padding-right: 2.25rem !important;
}
html[dir="rtl"] .menu-vertical .menu-sub .menu-sub .menu-link {
  padding-left: 0 !important;
  padding-right: 2.9rem !important;
}
html[dir="rtl"] .menu-vertical .menu-sub .menu-sub .menu-sub .menu-link {
  padding-left: 0 !important;
  padding-right: 3.55rem !important;
}

/* Text alignment helpers (Bootstrap) */
html[dir="rtl"] .text-end {
  text-align: left !important;
}
html[dir="rtl"] .text-start {
  text-align: right !important;
}

/* Offcanvas / small screens: ensure menu slides from the right */
@media (max-width: 1199.98px) {
  html[dir="rtl"].layout-menu-fixed-offcanvas .layout-menu {
    right: 0 !important;
    left: auto !important;
  }
  html[dir="rtl"] .layout-page {
    padding-right: 0 !important;
    padding-left: 0 !important;
  }
}


/* === RTL (Arabic UI) - Sneat layout overrides === */
html[dir="rtl"] body { font-family: "Cairo", "Public Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

html[dir="rtl"] .layout-menu { left: auto !important; right: 0 !important; }
html[dir="rtl"] .layout-menu-fixed:not(.layout-menu-collapsed) .layout-page,
html[dir="rtl"] .layout-menu-fixed-offcanvas:not(.layout-menu-collapsed) .layout-page{
  padding-left: 0 !important;
  padding-right: 16.25rem !important;
}

/* Desktop: if menu is collapsed, keep page aligned */
html[dir="rtl"].layout-menu-collapsed .layout-page,
html[dir="rtl"] .layout-menu-collapsed .layout-page{
  padding-right: 0 !important;
}

/* Mobile/tablet offcanvas: hidden to the RIGHT by default */
@media (max-width: 1199.98px){
  html[dir="rtl"] .layout-menu{
    left: auto !important;
    right: 0 !important;
    transform: translate3d(100%, 0, 0) !important;
  }
  html[dir="rtl"].layout-menu-expanded .layout-menu{
    transform: translate3d(0, 0, 0) !important;
  }
  /* Make sure content is full width when menu is hidden */
  html[dir="rtl"] .layout-page{
    padding-right: 0 !important;
  }
}

/* Utility swaps for RTL */
html[dir="rtl"] .ms-auto { margin-left: 0 !important; margin-right: auto !important; }
html[dir="rtl"] .ms-1 { margin-left: 0 !important; margin-right: .25rem !important; }
html[dir="rtl"] .me-2 { margin-right: 0 !important; margin-left: .5rem !important; }
html[dir="rtl"] .me-3 { margin-right: 0 !important; margin-left: 1rem !important; }
html[dir="rtl"] .text-end { text-align: left !important; }



/* RTL: put the menu toggle (close button) on the LEFT side inside the right-side menu */
html[dir="rtl"] .layout-menu .app-brand { flex-direction: row-reverse !important; }
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle { margin: 0 !important; }
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle i { transform: rotate(180deg); }



/* RTL: put menu toggle on the LEFT inside the menu header */
html[dir="rtl"] .layout-menu .app-brand {
  flex-direction: row-reverse !important;
  justify-content: space-between !important;
}
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle {
  margin-left: 0 !important;
  margin-right: 0 !important;
}
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle.menu-link {
  margin-left: 0 !important;
  margin-right: 0 !important;
}


/* RTL FIX: force menu close/toggle button to the LEFT inside the side menu header */
html[dir="rtl"] .layout-menu .app-brand {
  position: relative !important;
  display: flex !important;
  align-items: center !important;
}
html[dir="rtl"] .layout-menu .app-brand .app-brand-link {
  margin-right: 0 !important;
  margin-left: auto !important; /* keep brand on the right */
}
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle {
  position: absolute !important;
  left: .75rem !important;
  right: auto !important;
  margin: 0 !important;
}
html[dir="rtl"] .layout-menu .app-brand .layout-menu-toggle i.bx {
  transform: rotate(180deg);
}


/* small helpers */
#lessonDoneBadge { vertical-align: middle; }


/* Admin-only menu items */
[data-admin-only]{ display:none; }
body.admin-mode [data-admin-only]{ display:block; }


/* Lesson resources */
#lessonResources .list-group-item { gap: .5rem; }
html[dir="rtl"] #lessonResources .text-truncate { text-align: right; }



/* --- AI Assistant (Lesson) --- */
.ai-chat { display:flex; flex-direction:column; gap:.75rem; }
.ai-chat-toolbar { display:flex; flex-wrap:wrap; gap:.5rem; align-items:center; }
.ai-chat-messages { border:1px solid rgba(67,89,113,.2); border-radius:.5rem; padding:.75rem; max-height: 340px; overflow:auto; background: rgba(67,89,113,.02); }
.ai-msg { display:flex; gap:.5rem; margin-bottom:.65rem; }
.ai-msg:last-child { margin-bottom:0; }
.ai-msg .ai-bubble { padding:.55rem .7rem; border-radius:.65rem; max-width: 100%; white-space: pre-wrap; word-break: break-word; }
.ai-msg.user { justify-content:flex-end; }
.ai-msg.user .ai-bubble { background: rgba(105,108,255,.12); border:1px solid rgba(105,108,255,.25); }
.ai-msg.assistant .ai-bubble { background: #fff; border:1px solid rgba(67,89,113,.18); }
.ai-msg .ai-meta { font-size:.72rem; opacity:.65; margin-top:.15rem; }
.ai-chat-status { font-size:.85rem; }
html[dir="rtl"] .ai-chat-toolbar { flex-direction: row-reverse; }
html[dir="rtl"] .ai-msg.user { justify-content:flex-start; }

/* --- Navbar language dropdown + static profile placeholder --- */
.lh-profile-placeholder{
  width: 34px;
  height: 34px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: rgba(67, 89, 113, 0.08);
  border: 1px solid rgba(67, 89, 113, 0.12);
}

.navbar-nav.flex-row{ column-gap: .25rem; }

/* --- RTL navbar fixes (AR) ---
   Goal:
   - Search input stays on the FAR RIGHT of the topbar
   - Profile icon goes to the FAR LEFT
   - Language button sits just to the RIGHT of profile
   - Dropdown opens inward (to the right), never off-screen
*/
html[dir="rtl"] #layout-navbar #navbar-collapse{
  width: 100%;
  flex-direction: row !important;
  justify-content: space-between !important;
}

/* Make the action group (lang/profile) the left block, and search the right block */
html[dir="rtl"] #layout-navbar #navbar-collapse > ul.navbar-nav{
  order: 1;
  margin-left: 0 !important;
}
html[dir="rtl"] #layout-navbar #navbar-collapse > .navbar-nav.align-items-center{
  order: 2;
  margin-right: 0 !important;
}

/* Inside the action group: Profile far-left, Language to its right */
/* RTL navbar actions order: Language then Profile (leftmost) */
html[dir="rtl"] .lh-lang-item{ order: 1; }
html[dir="rtl"] .lh-profile-item{ order: 2; }

/* In RTL, force the language dropdown to open inward (to the right) */
html[dir="rtl"] .lang-dropdown-menu{
  left: 0 !important;
  right: auto !important;
}


/* Global loader overlay */
#lhGlobalLoader.lh-loader{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,.55);
  z-index: 2000;
  backdrop-filter: blur(1px);
}
body.lh-loading{ overflow: hidden; }

/* --- Responsive tables -> cards on mobile ---
   Any <table> enhanced by ui.js receives .lh-table-cards.
   On small screens, we render each row as a card and print header labels
   using td::before (from data-label).
*/

@media (max-width: 768px){
  .lh-table-responsive-cards{ overflow-x: visible !important; }

  table.lh-table-cards{ border: 0; }
  table.lh-table-cards thead{ display:none; }
  table.lh-table-cards tbody{ display:block; }
  table.lh-table-cards tbody tr{
    display:block;
    margin: 0 0 .75rem 0;
    padding: .75rem .85rem;
    border: 1px solid rgba(67, 89, 113, 0.16);
    border-radius: .75rem;
    background: #fff;
    box-shadow: 0 2px 10px rgba(67, 89, 113, 0.06);
  }

  table.lh-table-cards tbody td,
  table.lh-table-cards tbody th{
    /* Stack label above value to avoid horizontal stretching on mobile */
    display:block;
    padding: .35rem 0;
    border: 0 !important;
    /* Override .text-nowrap wrappers in the template */
    white-space: normal !important;
    overflow-wrap: anywhere;
    word-break: break-word;
    min-width: 0;
  }

  table.lh-table-cards tbody td::before,
  table.lh-table-cards tbody th::before{
    content: attr(data-label);
    font-weight: 600;
    color: rgba(67, 89, 113, 0.85);
    display:block;
    margin-bottom: .15rem;
    max-width: 100%;
  }

  /* Actions column: show buttons together and always visible */
  table.lh-table-cards tbody td.lh-td-actions,
  table.lh-table-cards tbody th.lh-td-actions{
    display:flex;
    justify-content: flex-end;
    flex-wrap: wrap;
    gap: .5rem;
    margin-top: .35rem;
    padding-top: .65rem;
    border-top: 1px dashed rgba(67, 89, 113, 0.18) !important;
  }
  table.lh-table-cards tbody td.lh-td-actions::before,
  table.lh-table-cards tbody th.lh-td-actions::before{
    content: "";
    display:none;
  }

  /* RTL: keep label/value spacing natural */
  /* RTL: labels/values are stacked, keep actions aligned nicely */
  html[dir="rtl"] table.lh-table-cards tbody td.lh-td-actions,
  html[dir="rtl"] table.lh-table-cards tbody th.lh-td-actions{
    justify-content: flex-start;
  }
}

/* Generic helper to wrap long texts (course descriptions, lesson titles, etc.) */
.lh-wrap{
  white-space: normal !important;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* --- AI Assistant Drawer --- */
.lh-ai-drawer{ width:min(520px, 92vw); }
.lh-ai-drawer .ai-chat-messages{ max-height: 52vh; }
.lh-ai-drawer .offcanvas-body{ display:flex; flex-direction:column; }
.lh-ai-drawer .ai-chat{ flex:1 1 auto; }
@media (max-width: 576px){
  .lh-ai-drawer{ width: 100vw; }
  .lh-ai-drawer .ai-chat-messages{ max-height: 50vh; }
}
